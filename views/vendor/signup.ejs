<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SignUP page</title>
    <!-- SweetAlert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="../../styles/vendor/signup.css">
</head>

<body>
    <div class="page-title">SignUP page</div>

    <div class="container">
        <div class="header">
            <h1 class="main-title">Sign up</h1>
            <p class="subtitle">sign up to your Vendor Account</p>
        </div>

        <form>
            <div class="form-group">
                <label class="form-label" for="brandName">Brand Name</label>
                <input type="text" id="brandName" class="form-input" placeholder="Label (required)">
            </div>

            <div class="form-group">
                <label class="form-label" for="brandEmail">Brand Email</label>
                <input type="text" id="brandEmail" class="form-input" placeholder="Label (required)">
            </div>

            <div class="form-group">
                <label class="form-label" for="phoneNumber">Phone Number</label>
                <input type="tel" id="phoneNumber" class="form-input" placeholder="Label (required)">
            </div>

            <div class="form-group">
                <label class="form-label" for="password">Password</label>
                <div class="password-container">
                    <input type="password" id="password" class="form-input" value="@Safvan9633" placeholder="Label (required)">
                </div>
            </div>

            <div class="form-group">
                <label class="form-label" for="confirmPassword">Confirm password</label>
                <div class="password-container">
                    <input type="password" id="confirmPassword" class="form-input" value="@Safvan9633" placeholder="Label (required)">
                </div>
            </div>

            <div class="login-link-container">
                Already have an account? <span class="login-link">Log In</span>
            </div>

            <button type="submit" class="signup-button">Sign Up</button>
        </form>
    </div>

    <script type="module">
        //axios
        import axios from "https://cdn.jsdelivr.net/npm/axios@1.6.7/+esm";
        //validation
        import { validateSignUpForm } from "/js/utils/formValidator.js";

        // Form validation
        document.querySelector('form').addEventListener('submit', async function (e) {
            e.preventDefault();

            const brandName = document.getElementById('brandName').value;
            const brandEmail = document.getElementById('brandEmail').value;
            const phoneNumber = document.getElementById('phoneNumber').value;
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            console.log(brandEmail, brandName, phoneNumber, password, confirmPassword)
            //frontend validation
            const { isValid, messages } = validateSignUpForm(brandEmail, brandEmail, phoneNumber, password, confirmPassword);
            if (!isValid) {
                Swal.fire({
                    icon: 'error',
                    title: 'Validation Error',
                    html: messages.join('<br>')
                });
                return;
            }

            // Submit form data
            try {
                const response = await axios.post("/vendor/signup", { brandName, brandEmail, phoneNumber, password, confirmPassword });
                const result = response.data;
                if (result.success) {
                    Swal.fire({
                        icon: 'success',
                        title: 'Success',
                        text: result.message
                    }).then(() => {
                        window.location.href = result.redirect;
                    });
                }
            } catch (error) {
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: error.response?.data?.message || "Something went wrong"
                });
            }
        });
    </script>
</body>

</html>